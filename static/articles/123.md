<!-- title:Macアプリ配布用の.dmgの作成方法（2019 Mojave版） -->

自作アプリがどうも AppStore 経由では配信できなさそうなので，よくある`.dmg`形式で配布しようと思いやり方を探したら，[カスタマイズした.dmg を作成する方法](https://qiita.com/econa77/items/d0e7d3a75d8fd3bb7777)という記事を見つけました．しかし，どうやら現在はほんの少しやり方が変わっていたようので，改めてここに書き残します．

# 環境

macOS Mojave: 10.14.5

# 素材の準備

## 配布用アプリ

アプリが完成したら，Developer ID としてアプリをエクスポートしてください．

![へ.png](./images/article/087be305-fa3c-775b-11b9-c78e8fada457.png)
![ほ.png](./images/article/4752789b-b5fe-2d1b-cb9f-cbdfaf1558cd.png)

あとは流れでよいしょ．
`〜.app`が生成されれば OK

## 背景画像

dmg の背景に使用する画像を作成してください．

![a.png](./images/article/de8d7347-f3d8-9e7a-a5b2-0c3a44469b22.png)

retina に対応するために，1 倍のものと 2 倍のもの（1200px × 750px くらい？）を用意します．そうしたら，Terminal を使って以下のコマンドで背景用画像の`.tiff`ファイルを生成します．

```plaintext
$ tiffutil -cathidpicheck １倍の背景画像 2倍の背景画像 -out backImage.tiff
```

## Applications フォルダのエイリアス

`Macintosh HD`の中の`アプリケーション`フォルダのエイリアスを作ります．

# dmg の作成

ディスクユーティリティを開いてメニューバーのファイル>新規イメージ>空のイメージを作成を押します．

![b.png](./images/article/dda1065d-3687-c255-9123-83d8d7ea4335.png)

編集する項目は名前だけです．アプリの配布が目的なので，「アプリ名\_バージョン」とすると良いと思います．

![c.png](./images/article/e42f6e84-8b8b-e925-f69a-7f022f6a6798.png)

そうすると，デスクトップに`．dmg`と`ボリューム`が生成表示されますのでボリュームを開いて，ボリュームの中に配布用アプリとアプリケーションフォルダのエイリアスをコピーします．続いて terminal を用いてボリュームの中に`.resource`という名前の隠しフォルダを作り，中に背景用画像を入れます．

ここまでできたらあともう少し，ボリュームのウィンドウを選択した状態で表示オプションを表示し，アイコンのサイズと背景画像を設定します．(背景画像は`.resource`フォルダの中のものをドラッグ&ドロップ)最後にアイコンの位置とウィンドウサイズを微調整したら，ボリュームのマウントを外せば`.dmg`の完成です．確認のために出来上がった`.dmg`を一度展開してボリュームを開いて見た目を確認しましょう．(`.dmg`を直接編集していないので不思議な気持ちになるかもしれませんが，これで OK なのです．)

![d.png](./images/article/0e2a9582-1a86-3799-7f87-45b0abf84b31.png)

# 所感

背景画像を用意するのは面倒ですが，案外簡単に作ることができますね．

# 参考

[カスタマイズした.dmg を作成する方法](https://qiita.com/econa77/items/d0e7d3a75d8fd3bb7777)
[Xcode : Mac 用アプリを Mac App Store を使用せずに個人配布する|配布用.dmg ファイルの作成](https://hikaruapp.jpn.com/xcode/osx/post-645)
